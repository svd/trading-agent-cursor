# Запись в журнал сделок

## Задача

Записать информацию о завершённой сделке в журнал для последующего анализа.

## Обязательная информация

### Основные данные
- Дата и время входа
- Символ инструмента
- Направление (Long/Short)
- Цена входа
- Цена выхода
- Время выхода

### Плановые данные
- Планируемый стоп-лосс
- Планируемые тейк-профиты
- Планируемый размер позиции

### Результаты
- Прибыль/убыток в $
- Прибыль/убыток в %
- Достигнутый R:R
- Причина выхода (TP, SL, досрочный выход)

### Анализ
- Соблюдение плана (Да/Нет)
- Ошибки, если были
- Уроки, которые можно извлечь
- Заметки

## Процесс

1. Собрать информацию о сделке:
   - От трейдера (вход, выход, цены)
   - Из плана (стоп-лосс, тейк-профиты)
   - Рассчитать P/L и R:R

2. Проанализировать сделку:
   - Следовал ли плану?
   - Какие ошибки были?
   - Что можно улучшить?

3. Записать в журнал:
   - Markdown файл для читаемости
   - JSON строка для автоматического анализа

## Формат вывода

### Markdown (`journal/YYYY-MM/YYYY-MM-DD.md`)

```markdown
### {SYMBOL} {Direction}

- **Вход**: {entry_price} @ {entry_time}
- **Выход**: {exit_price} @ {exit_time}
- **P/L**: {pnl} ({pnl_percent}%)
- **Соблюдение плана**: {yes/no}
- **Причина выхода**: {reason}
- **Заметки**: {notes}

**Ошибки**:
- {mistake 1}
- {mistake 2}

**Уроки**:
- {lesson 1}
- {lesson 2}
```

### JSON (`journal/YYYY-MM/trades.jsonl`)

```json
{
  "date": "2026-01-23",
  "symbol": "AAPL",
  "direction": "long",
  "entry_price": 185.62,
  "entry_time": "10:45",
  "exit_price": 186.80,
  "exit_time": "14:20",
  "stop_loss": 184.90,
  "take_profit": [187.00, 189.50],
  "pnl": 118.00,
  "pnl_percent": 0.64,
  "risk_reward": 2.0,
  "plan_followed": true,
  "exit_reason": "early_exit",
  "notes": "Вышел раньше TP1 из-за новостей",
  "mistakes": [],
  "lessons": ["Следить за экономическим календарём перед входом"]
}
```

## Важные правила

1. **Записывать все сделки** — включая убыточные
2. **Быть честным** — не скрывать ошибки
3. **Анализировать** — извлекать уроки из каждой сделки
4. **Регулярно** — записывать сразу после закрытия позиции
