---
description: –ü—Ä–∞–≤–∏–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤ —á–µ—Ä–µ–∑ MCP generate_chart. –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
alwaysApply: false
---

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ —á–µ—Ä–µ–∑ MCP generate_chart

## –í–∞–∂–Ω–æ: –û –ø—Ä–∏–º–µ—Ä–∞—Ö –∫–æ–¥–∞

**–ü—Ä–∏–º–µ—Ä—ã –Ω–∞ Python –≤ —ç—Ç–æ–º –ø—Ä–∞–≤–∏–ª–µ –ù–ï —è–≤–ª—è—é—Ç—Å—è –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º –∫–æ–¥–æ–º.** –≠—Ç–æ **–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏** –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏–π.

**–ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **MCP –≤—ã–∑–æ–≤—ã** —á–µ—Ä–µ–∑ `call_mcp_tool` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤** (`read_file`, `list_dir`) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- –°–ª–µ–¥–æ–≤–∞—Ç—å **–ª–æ–≥–∏–∫–µ**, –ø–æ–∫–∞–∑–∞–Ω–Ω–æ–π –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö, –Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –µ—ë —á–µ—Ä–µ–∑ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

**–ü—Ä–∏–º–µ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å (—Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞, —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞)
- –ö–∞–∫ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ (—Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫, —É—Å–ª–æ–≤–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏)
- –ö–æ–≥–¥–∞ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è (–ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –ø–æ—Å–ª–µ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫)

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏—è

### 1. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–π–ª

**–ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ** –≤—Å–µ–≥–¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫ –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª.

**–î–µ–π—Å—Ç–≤–∏—è –∞–≥–µ–Ω—Ç–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≥—Ä–∞—Ñ–∏–∫–∞ (–∏—Å–ø–æ–ª—å–∑—É—è `read_file` –∏–ª–∏ `list_dir`)
2. –ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –ø—Ä–æ—Å—Ç–æ —Å–æ–æ–±—â–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
3. **–í–°–ï–ì–î–ê** –≤—ã–∑–≤–∞—Ç—å MCP `generate_chart` –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ (—Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
4. **–ù–ï –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å** –≥–µ–Ω–µ—Ä–∞—Ü–∏—é, –¥–∞–∂–µ –µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–õ–æ–≥–∏–∫–∞ (–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è, –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥):**
```python
# –≠—Ç–æ –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥, –∞ –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
chart_path = "homework/2026-01-25/NVDA_chart_5months.png"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ read_file/list_dir)
if file_exists(chart_path):
    # –°–æ–æ–±—â–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
    print("–ì—Ä–∞—Ñ–∏–∫ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É—é...")
else:
    print("–ì–µ–Ω–µ—Ä–∏—Ä—É—é –Ω–æ–≤—ã–π –≥—Ä–∞—Ñ–∏–∫...")

# –í–°–ï–ì–î–ê –≤—ã–∑–≤–∞—Ç—å MCP generate_chart —á–µ—Ä–µ–∑ call_mcp_tool (–ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Ñ–∞–π–ª, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
call_mcp_tool(server="user-markethub-mcp", toolName="generate_chart", ...)
```

### 2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –∏ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–∞—Ç

**–ú–ê–ö–°–ò–ú–£–ú 3 –ø–æ–ø—ã—Ç–∫–∏** –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ —Å —É–º–µ–Ω—å—à–µ–Ω–∏–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–∞—Ç –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ.

**–î–µ–π—Å—Ç–≤–∏—è –∞–≥–µ–Ω—Ç–∞:**
1. –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞: –¥–∏–∞–ø–∞–∑–æ–Ω **5 –º–µ—Å—è—Ü–µ–≤** (`start_date`: –¥–∞—Ç–∞ 5 –º–µ—Å—è—Ü–µ–≤ –Ω–∞–∑–∞–¥)
2. –ï—Å–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å - –≤—Ç–æ—Ä–∞—è –ø–æ–ø—ã—Ç–∫–∞: –¥–∏–∞–ø–∞–∑–æ–Ω **4 –º–µ—Å—è—Ü–∞** (`start_date`: –¥–∞—Ç–∞ 4 –º–µ—Å—è—Ü–∞ –Ω–∞–∑–∞–¥)
3. –ï—Å–ª–∏ –≤—Ç–æ—Ä–∞—è –ø–æ–ø—ã—Ç–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å - —Ç—Ä–µ—Ç—å—è –ø–æ–ø—ã—Ç–∫–∞: –¥–∏–∞–ø–∞–∑–æ–Ω **3 –º–µ—Å—è—Ü–∞** (`start_date`: –¥–∞—Ç–∞ 3 –º–µ—Å—è—Ü–∞ –Ω–∞–∑–∞–¥)
4. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—à–Ω–æ—Å—Ç—å (–ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ–≥–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `read_file`/`list_dir`)
5. –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ - **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**
6. –ü–æ—Å–ª–µ 3 –ø–æ–ø—ã—Ç–æ–∫ - **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø** –∏ —Å–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ

**–õ–æ–≥–∏–∫–∞ (–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è, –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥):**
```python
# –≠—Ç–æ –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥, –∞ –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
# –î–∏–∞–ø–∞–∑–æ–Ω—ã –¥–∞—Ç –¥–ª—è –ø–æ–ø—ã—Ç–æ–∫: 5 ‚Üí 4 ‚Üí 3 –º–µ—Å—è—Ü–∞
date_ranges = [5, 4, 3]  # –º–µ—Å—è—Ü—ã –Ω–∞–∑–∞–¥ –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
retry_count = 0
MAX_RETRIES = 3

for months_back in date_ranges:
    retry_count += 1
    
    # –í—ã—á–∏—Å–ª–∏—Ç—å start_date (–º–µ—Å—è—Ü–µ–≤ –Ω–∞–∑–∞–¥ –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã)
    start_date = current_date - months_back months
    end_date = current_date
    
    # –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ OHLCV –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
    ohlcv_data = call_mcp_tool(
        server="user-markethub-mcp",
        toolName="get_stock_history",
        arguments={"symbol": "NVDA", "start_date": start_date, "end_date": end_date, "interval": "1d"}
    )
    
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
    chart_input = {
        "ticker": "NVDA",
        "title": f"NVDA - {months_back} –º–µ—Å—è—Ü–µ–≤",
        "ohlcv": ohlcv_data,
        "levels": [...],
        "chart_type": "candle",
        "style": "light"
    }
    
    # –í—ã–∑–æ–≤ MCP generate_chart (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ call_mcp_tool)
    result = call_mcp_tool(
        server="user-markethub-mcp",
        toolName="generate_chart",
        arguments={"input_data": chart_input}
    )
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ read_file –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è)
    if file_exists_and_not_empty(chart_path):
        print(f"‚úÖ –ì—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω/–æ–±–Ω–æ–≤–ª–µ–Ω (–¥–∏–∞–ø–∞–∑–æ–Ω: {months_back} –º–µ—Å—è—Ü–µ–≤)")
        break  # –û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø - —É—Å–ø–µ—Ö
    else:
        if retry_count < MAX_RETRIES:
            print(f"‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∞ {retry_count} –Ω–µ—É–¥–∞—á–Ω–∞ (–¥–∏–∞–ø–∞–∑–æ–Ω: {months_back} –º–µ—Å—è—Ü–µ–≤). –ü—Ä–æ–±—É—é –º–µ–Ω—å—à–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω...")
        else:
            print(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ—Å–ª–µ {MAX_RETRIES} –ø–æ–ø—ã—Ç–æ–∫")
            break  # –û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø - –∏—Å—á–µ—Ä–ø–∞–Ω—ã –ø–æ–ø—ã—Ç–∫–∏
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞

**–í–°–ï–ì–î–ê** –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–∞ MCP `generate_chart`.

**–î–µ–π—Å—Ç–≤–∏—è –∞–≥–µ–Ω—Ç–∞:**
1. –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ `call_mcp_tool` —Å `generate_chart` –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `read_file` –∏–ª–∏ `list_dir` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
3. –ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –ø—É—Å—Ç–æ–π - **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**, —É—Å–ø–µ—Ö
4. –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —Å–æ–∑–¥–∞–Ω –∏–ª–∏ –ø—É—Å—Ç–æ–π - –ø–æ–≤—Ç–æ—Ä–∏—Ç—å (–º–∞–∫—Å–∏–º—É–º 2-3 —Ä–∞–∑–∞)

**–õ–æ–≥–∏–∫–∞ (–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è, –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥):**
```python
# –≠—Ç–æ –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥, –∞ –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
# –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ MCP generate_chart —á–µ—Ä–µ–∑ call_mcp_tool

# –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ read_file/list_dir):
if file_exists(chart_path):
    if file_size(chart_path) > 0:
        print("‚úÖ –ì—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω/–æ–±–Ω–æ–≤–ª–µ–Ω")
        return  # –û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø - –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
    else:
        print("‚ö†Ô∏è –§–∞–π–ª —Å–æ–∑–¥–∞–Ω, –Ω–æ –ø—É—Å—Ç–æ–π")
else:
    print("‚ùå –§–∞–π–ª –Ω–µ —Å–æ–∑–¥–∞–Ω")
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ

**–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ** –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π OHLCV **–æ–¥–∏–Ω —Ä–∞–∑** –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å –Ω–æ–≤—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º.

**–î–µ–π—Å—Ç–≤–∏—è –∞–≥–µ–Ω—Ç–∞:**
1. –ù–∞—á–∞—Ç—å —Å –¥–∏–∞–ø–∞–∑–æ–Ω–∞ **5 –º–µ—Å—è—Ü–µ–≤** (`start_date`: –¥–∞—Ç–∞ 5 –º–µ—Å—è—Ü–µ–≤ –Ω–∞–∑–∞–¥)
2. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ OHLCV —á–µ—Ä–µ–∑ MCP `get_stock_history` (–∏—Å–ø–æ–ª—å–∑—É—è `call_mcp_tool`) –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π **–æ–¥–∏–Ω —Ä–∞–∑** –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
4. –í—ã–∑–≤–∞—Ç—å MCP `generate_chart` —Å –¥–∞–Ω–Ω—ã–º–∏
5. –ï—Å–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å - —É–º–µ–Ω—å—à–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–æ **4 –º–µ—Å—è—Ü–µ–≤** –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —à–∞–≥–∏ 2-4
6. –ï—Å–ª–∏ –≤—Ç–æ—Ä–∞—è –ø–æ–ø—ã—Ç–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å - —É–º–µ–Ω—å—à–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–æ **3 –º–µ—Å—è—Ü–µ–≤** –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —à–∞–≥–∏ 2-4
7. **–ù–ï –ø—Ä–æ–≤–µ—Ä—è—Ç—å** –¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å —Ç–µ–º –∂–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º (—ç—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ!)

**–õ–æ–≥–∏–∫–∞ (–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è, –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥):**
```python
# ‚úÖ –•–û–†–û–®–û - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–¥–∏–Ω —Ä–∞–∑ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–æ–π —Å –Ω–æ–≤—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º
# –î–∏–∞–ø–∞–∑–æ–Ω—ã: 5 ‚Üí 4 ‚Üí 3 –º–µ—Å—è—Ü–∞
for months_back in [5, 4, 3]:
    # –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ MCP get_stock_history (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ call_mcp_tool)
    start_date = current_date - months_back months
    ohlcv_data = call_mcp_tool(
        server="user-markethub-mcp",
        toolName="get_stock_history",
        arguments={"symbol": "NVDA", "start_date": start_date, "end_date": current_date, "interval": "1d"}
    )
    
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –û–î–ò–ù –†–ê–ó –¥–ª—è —ç—Ç–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
    if len(ohlcv_data) < expected_count:
        # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞, –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –º–µ–Ω—å—à–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω
        continue
    
    # –í—ã–∑–≤–∞—Ç—å MCP generate_chart (–ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Ñ–∞–π–ª, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
    result = call_mcp_tool(server="user-markethub-mcp", toolName="generate_chart", ...)
    
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    if file_exists_and_not_empty(chart_path):
        break  # –£—Å–ø–µ—Ö - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è

# ‚ùå –ü–õ–û–•–û - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ü–∏–∫–ª–µ –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å —Ç–µ–º –∂–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º
# –ù–ï –¥–µ–ª–∞–π—Ç–µ —ç—Ç–æ! –≠—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ!
```

### 5. –ó–∞–ø—Ä–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞** (—Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –∏ –Ω–µ –ø—É—Å—Ç–æ–π) **–ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å** –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏–ª–∏ –≤–µ—Ä—Å–∏–∏.

**–î–µ–π—Å—Ç–≤–∏—è –∞–≥–µ–Ω—Ç–∞:**
1. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞ (—Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –ø—É—Å—Ç–æ–π) - **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**, –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
2. **–ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å** –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ (3 –∏ 4 –º–µ—Å—è—Ü–∞) –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
3. **–ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å** –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞ (OHLC-–≤–µ—Ä—Å–∏–∏, –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤) –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
4. –î–∏–∞–ø–∞–∑–æ–Ω—ã 4 –∏ 3 –º–µ—Å—è—Ü–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º 5 –º–µ—Å—è—Ü–µ–≤
5. –ï—Å–ª–∏ –≥—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º 5 –º–µ—Å—è—Ü–µ–≤ ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è 4 –∏ 3 –º–µ—Å—è—Ü–µ–≤, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å OHLC-–≤–µ—Ä—Å–∏–∏
6. –ï—Å–ª–∏ –≥—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º 4 –º–µ—Å—è—Ü–∞ ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è 3 –º–µ—Å—è—Ü–µ–≤, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å OHLC-–≤–µ—Ä—Å–∏–∏
7. –ï—Å–ª–∏ –≥—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º 3 –º–µ—Å—è—Ü–∞ ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å OHLC-–≤–µ—Ä—Å–∏–∏

**–õ–æ–≥–∏–∫–∞ (–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è, –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥):**
```python
# –≠—Ç–æ –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥, –∞ –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
# –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ read_file/list_dir)
if file_exists_and_not_empty(chart_path):
    print("‚úÖ –ì—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω/–æ–±–Ω–æ–≤–ª–µ–Ω")
    # –û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø - –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏–ª–∏ –≤–µ—Ä—Å–∏–∏
    return  # –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
    
    # ‚ùå –ù–ï –î–ï–õ–ê–¢–¨:
    # - –°–æ–∑–¥–∞–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ (3 –∏ 4 –º–µ—Å—è—Ü–∞)
    # - –°–æ–∑–¥–∞–≤–∞—Ç—å OHLC-–≤–µ—Ä—Å–∏–∏
    # - –°–æ–∑–¥–∞–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤
```

## –ê–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞

1. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –≥—Ä–∞—Ñ–∏–∫–∞**
2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å —É–º–µ–Ω—å—à–µ–Ω–∏–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ:**
   - **–ü–æ–ø—ã—Ç–∫–∞ 1**: –î–∏–∞–ø–∞–∑–æ–Ω **5 –º–µ—Å—è—Ü–µ–≤**
     - –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ MCP `get_stock_history` —Å `start_date` = –¥–∞—Ç–∞ 5 –º–µ—Å—è—Ü–µ–≤ –Ω–∞–∑–∞–¥
     - –í—ã–∑–≤–∞—Ç—å MCP `generate_chart` —á–µ—Ä–µ–∑ `call_mcp_tool`
     - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—à–Ω–æ—Å—Ç—å (—Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –ø—É—Å—Ç–æ–π)
     - –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø, –£–°–ü–ï–•**
   - **–ü–æ–ø—ã—Ç–∫–∞ 2** (–µ—Å–ª–∏ –ø–æ–ø—ã—Ç–∫–∞ 1 –Ω–µ —É–¥–∞–ª–∞—Å—å): –î–∏–∞–ø–∞–∑–æ–Ω **4 –º–µ—Å—è—Ü–∞**
     - –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ MCP `get_stock_history` —Å `start_date` = –¥–∞—Ç–∞ 4 –º–µ—Å—è—Ü–∞ –Ω–∞–∑–∞–¥
     - –í—ã–∑–≤–∞—Ç—å MCP `generate_chart` —á–µ—Ä–µ–∑ `call_mcp_tool`
     - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—à–Ω–æ—Å—Ç—å (—Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –ø—É—Å—Ç–æ–π)
     - –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø, –£–°–ü–ï–•**
   - **–ü–æ–ø—ã—Ç–∫–∞ 3** (–µ—Å–ª–∏ –ø–æ–ø—ã—Ç–∫–∞ 2 –Ω–µ —É–¥–∞–ª–∞—Å—å): –î–∏–∞–ø–∞–∑–æ–Ω **3 –º–µ—Å—è—Ü–∞**
     - –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ MCP `get_stock_history` —Å `start_date` = –¥–∞—Ç–∞ 3 –º–µ—Å—è—Ü–∞ –Ω–∞–∑–∞–¥
     - –í—ã–∑–≤–∞—Ç—å MCP `generate_chart` —á–µ—Ä–µ–∑ `call_mcp_tool`
     - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—à–Ω–æ—Å—Ç—å (—Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –ø—É—Å—Ç–æ–π)
     - –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø, –£–°–ü–ï–•**
3. **–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
   - –ï—Å–ª–∏ –≥—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø, –ó–ê–í–ï–†–®–ò–¢–¨ –ü–†–û–¶–ï–°–°**
   - **–ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å** –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞ (OHLC, –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã)
   - **–ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å** –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
4. **–ü–æ—Å–ª–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫:**
   - –ï—Å–ª–∏ –Ω–∏ –æ–¥–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø, –°–û–û–ë–©–ò–¢–¨ –û–ë –û–®–ò–ë–ö–ï**
   - –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏ (5 ‚Üí 4 ‚Üí 3 –º–µ—Å—è—Ü–∞)

## –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –∞–≥–µ–Ω—Ç–∞

**–≠—Ç–æ –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∞–≥–µ–Ω—Ç–∞, –∞ –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥:**

1. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –≥—Ä–∞—Ñ–∏–∫–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `homework/2026-01-25/NVDA_chart_5months.png`)

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞** (–∏—Å–ø–æ–ª—å–∑—É—è `read_file` –∏–ª–∏ `list_dir`)
   - –ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - —Å–æ–æ–±—â–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
   - –§–∞–π–ª –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å —É–º–µ–Ω—å—à–µ–Ω–∏–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ:**
   
   **–ü–æ–ø—ã—Ç–∫–∞ 1: –î–∏–∞–ø–∞–∑–æ–Ω 5 –º–µ—Å—è—Ü–µ–≤**
   - –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ OHLCV —á–µ—Ä–µ–∑ MCP `get_stock_history` (–∏—Å–ø–æ–ª—å–∑—É—è `call_mcp_tool`)
     - `start_date`: –¥–∞—Ç–∞ 5 –º–µ—Å—è—Ü–µ–≤ –Ω–∞–∑–∞–¥ (—Ñ–æ—Ä–º–∞—Ç: "YYYY-MM-DD")
     - `end_date`: —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞ (—Ñ–æ—Ä–º–∞—Ç: "YYYY-MM-DD")
     - `interval`: "1d"
   - –í—ã–∑–≤–∞—Ç—å MCP `generate_chart` —á–µ—Ä–µ–∑ `call_mcp_tool`:
     ```json
     {
       "server": "user-markethub-mcp",
       "toolName": "generate_chart",
       "arguments": {
         "input_data": {
           "ticker": "NVDA",
           "title": "NVDA - 5 –º–µ—Å—è—Ü–µ–≤",
           "ohlcv": [...],
           "levels": [...],
           "chart_type": "candle",
           "style": "light"
         }
       }
     }
     ```
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—à–Ω–æ—Å—Ç—å (–∏—Å–ø–æ–ª—å–∑—É—è `read_file` –∏–ª–∏ `list_dir`)
   - –ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –ø—É—Å—Ç–æ–π ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**, —É—Å–ø–µ—Ö
   
   **–ü–æ–ø—ã—Ç–∫–∞ 2: –î–∏–∞–ø–∞–∑–æ–Ω 4 –º–µ—Å—è—Ü–∞** (–µ—Å–ª–∏ –ø–æ–ø—ã—Ç–∫–∞ 1 –Ω–µ —É–¥–∞–ª–∞—Å—å)
   - –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ OHLCV —á–µ—Ä–µ–∑ MCP `get_stock_history` —Å `start_date` = –¥–∞—Ç–∞ 4 –º–µ—Å—è—Ü–∞ –Ω–∞–∑–∞–¥
   - –í—ã–∑–≤–∞—Ç—å MCP `generate_chart` —Å `title`: "NVDA - 4 –º–µ—Å—è—Ü–∞"
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—à–Ω–æ—Å—Ç—å
   - –ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –ø—É—Å—Ç–æ–π ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**, —É—Å–ø–µ—Ö
   
   **–ü–æ–ø—ã—Ç–∫–∞ 3: –î–∏–∞–ø–∞–∑–æ–Ω 3 –º–µ—Å—è—Ü–∞** (–µ—Å–ª–∏ –ø–æ–ø—ã—Ç–∫–∞ 2 –Ω–µ —É–¥–∞–ª–∞—Å—å)
   - –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ OHLCV —á–µ—Ä–µ–∑ MCP `get_stock_history` —Å `start_date` = –¥–∞—Ç–∞ 3 –º–µ—Å—è—Ü–∞ –Ω–∞–∑–∞–¥
   - –í—ã–∑–≤–∞—Ç—å MCP `generate_chart` —Å `title`: "NVDA - 3 –º–µ—Å—è—Ü–∞"
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—à–Ω–æ—Å—Ç—å
   - –ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –ø—É—Å—Ç–æ–π ‚Üí **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**, —É—Å–ø–µ—Ö

4. **–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—à–Ω–æ—Å—Ç—å (—Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –ø—É—Å—Ç–æ–π)
   - **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**, –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
   - **–ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å** –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞ (OHLC, –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã)
   - **–ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å** –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤

5. **–ï—Å–ª–∏ –Ω–µ—É–¥–∞—á–∞ –ø–æ—Å–ª–µ –≤—Å–µ—Ö 3 –ø–æ–ø—ã—Ç–æ–∫:**
   - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∏ —Å–æ–æ–±—â–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–± –æ—à–∏–±–∫–µ
   - **–ù–ï –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å** –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏

## –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

‚ùå **–ù–ï –î–ï–õ–ê–¢–¨:**
- –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é, –µ—Å–ª–∏ —Ñ–∞–π–ª —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –≤—Å–µ–≥–¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å)
- –ü–æ–≤—Ç–æ—Ä—è—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –±–æ–ª–µ–µ 3 —Ä–∞–∑ (5 ‚Üí 4 ‚Üí 3 –º–µ—Å—è—Ü–∞) –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –±–æ–ª–µ–µ 5 –º–µ—Å—è—Ü–µ–≤ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–µ
- –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø–æ–ø—ã—Ç–∫–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –°–æ–∑–¥–∞–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ (3 –∏ 4 –º–µ—Å—è—Ü–∞) –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞
- –°–æ–∑–¥–∞–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞ (OHLC-–≤–µ—Ä—Å–∏–∏, –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã) –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π OHLCV –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤ —Ü–∏–∫–ª–µ –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å —Ç–µ–º –∂–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã Python –∫–∞–∫ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥ (–æ–Ω–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏)

## –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ (–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è, –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥)

**–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã, –Ω–æ –∞–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**

```python
# –≠—Ç–æ –ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥, –∞ –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –¥–ª—è –∞–≥–µ–Ω—Ç–∞
# –ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å call_mcp_tool, read_file, list_dir

# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ read_file/list_dir)
if file_exists(chart_path):
    print("üìä –ì—Ä–∞—Ñ–∏–∫ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É—é...")
else:
    print("üìä –ì–µ–Ω–µ—Ä–∏—Ä—É—é –Ω–æ–≤—ã–π –≥—Ä–∞—Ñ–∏–∫...")

# 2. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ OHLCV (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ call_mcp_tool —Å get_stock_history)
ohlcv_data = call_mcp_tool(server="user-markethub-mcp", toolName="get_stock_history", ...)

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –û–î–ò–ù –†–ê–ó
if len(ohlcv_data) < expected_count:
    ohlcv_data = call_mcp_tool(..., arguments={"start_date": ..., "end_date": ...})

# 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å —É–º–µ–Ω—å—à–µ–Ω–∏–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ
date_ranges = [5, 4, 3]  # –º–µ—Å—è—Ü—ã –Ω–∞–∑–∞–¥ –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
retry_count = 0
max_retries = 3

for months_back in date_ranges:
    retry_count += 1
    
    # –í—ã—á–∏—Å–ª–∏—Ç—å start_date (–º–µ—Å—è—Ü–µ–≤ –Ω–∞–∑–∞–¥ –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã)
    start_date = current_date - months_back months
    end_date = current_date
    
    # –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ OHLCV –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
    ohlcv_data = call_mcp_tool(
        server="user-markethub-mcp",
        toolName="get_stock_history",
        arguments={"symbol": "NVDA", "start_date": start_date, "end_date": end_date, "interval": "1d"}
    )
    
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
    chart_input = {
        "ticker": "NVDA",
        "title": f"NVDA - {months_back} –º–µ—Å—è—Ü–µ–≤",
        "ohlcv": ohlcv_data,
        "levels": [...],
        "chart_type": "candle",
        "style": "light"
    }
    
    # –í—ã–∑–æ–≤ MCP generate_chart (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ call_mcp_tool)
    result = call_mcp_tool(
        server="user-markethub-mcp",
        toolName="generate_chart",
        arguments={"input_data": chart_input}
    )
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ read_file/list_dir)
    if file_exists_and_not_empty(chart_path):
        print(f"‚úÖ –ì—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω/–æ–±–Ω–æ–≤–ª–µ–Ω (–¥–∏–∞–ø–∞–∑–æ–Ω: {months_back} –º–µ—Å—è—Ü–µ–≤)")
        break  # –û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø - —É—Å–ø–µ—Ö
    else:
        if retry_count < max_retries:
            print(f"‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∞ {retry_count} –Ω–µ—É–¥–∞—á–Ω–∞ (–¥–∏–∞–ø–∞–∑–æ–Ω: {months_back} –º–µ—Å—è—Ü–µ–≤). –ü—Ä–æ–±—É—é –º–µ–Ω—å—à–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω...")
        else:
            print(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ—Å–ª–µ {max_retries} –ø–æ–ø—ã—Ç–æ–∫")
            break  # –û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø - –∏—Å—á–µ—Ä–ø–∞–Ω—ã –ø–æ–ø—ã—Ç–∫–∏
```

## –í–∞–∂–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

- **–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è** - –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –≤—Å–µ–≥–¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª
- **–£–º–µ–Ω—å—à–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ** - –Ω–∞—á–∏–Ω–∞—Ç—å —Å 5 –º–µ—Å—è—Ü–µ–≤, –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ –ø—Ä–æ–±–æ–≤–∞—Ç—å 4 –º–µ—Å—è—Ü–∞, –∑–∞—Ç–µ–º 3 –º–µ—Å—è—Ü–∞
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫** - –º–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏ (5 ‚Üí 4 ‚Üí 3 –º–µ—Å—è—Ü–∞), –∑–∞—Ç–µ–º –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—Ö–∞** - –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ `generate_chart`
- **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞** - –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞ **–û–°–¢–ê–ù–û–í–ò–¢–¨–°–Ø**, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∏–ª–∏ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- **–ó–∞–ø—Ä–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≤–µ—Ä—Å–∏–π** - –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞ –ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ (OHLC, –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã) –∏ –ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ title** - –æ–±–Ω–æ–≤–ª—è—Ç—å `title` –≥—Ä–∞—Ñ–∏–∫–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º –¥–∞–Ω–Ω—ã—Ö (5/4/3 –º–µ—Å—è—Ü–∞)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP** - –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `call_mcp_tool` –¥–ª—è –≤—ã–∑–æ–≤–∞ `generate_chart` –∏ `get_stock_history`
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ñ–∞–π–ª–æ–≤** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `read_file` –∏ `list_dir` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- **–ü—Ä–∏–º–µ—Ä—ã Python** - —ç—Ç–æ –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏, –∞ –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥. –ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–º–µ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É —á–µ—Ä–µ–∑ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
